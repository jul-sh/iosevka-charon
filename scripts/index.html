<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Iosevka Charon Demo and Reports</title>
    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        line-height: 1.6;
        margin: 2rem auto;
        max-width: 960px;
        padding: 0 1.25rem;
      }

      header {
        margin-bottom: 2rem;
      }

      code {
        background: #f3f4f6;
        border-radius: 0.25rem;
        padding: 0.25rem 0.35rem;
      }

      .font-card {
        border: 1px solid #e5e7eb;
        border-radius: 0.5rem;
        padding: 1rem;
        margin: 1rem 0;
      }

      .sample {
        font-size: 1.25rem;
        margin-top: 0.5rem;
      }

      .reports ul {
        list-style: disc;
        padding-left: 1.5rem;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>Iosevka Charon QA and Demo</h1>
      <p>
        This page hosts the generated proof reports and quick previews of the
        built TTFs. Font files are served directly from the <code>ttf/</code>
        directory for quick inspection.
      </p>
      <div class="reports">
        <h2>Reports</h2>
        <ul>
          <li><a href="proof/diffenator2-report.html">Diffenator2 proof</a></li>
          <li>
            <a href="fontbakery">FontBakery markdown reports</a>
            (per-family markdown files)
          </li>
        </ul>
      </div>
    </header>

    <section id="fonts">
      <h2>Font demos</h2>
      <div id="font-container">Loading font previewsâ€¦</div>
    </section>

    <script>
      async function loadManifest() {
        try {
          const response = await fetch("./ttf_manifest.json");
          if (!response.ok) throw new Error("manifest not found");
          return await response.json();
        } catch (err) {
          console.error("Could not load manifest", err);
          document.getElementById("font-container").textContent =
            "TTF manifest could not be loaded.";
          return [];
        }
      }

      function createCard(path, index) {
        const fontId = `demo-font-${index}`;
        const card = document.createElement("div");
        card.className = "font-card";

        const title = document.createElement("div");
        title.textContent = path;
        card.appendChild(title);

        const style = document.createElement("style");
        style.textContent = `@font-face { font-family: "${fontId}"; src: url("${path}") format("truetype"); font-display: swap; }`;
        card.appendChild(style);

        const sample = document.createElement("div");
        sample.className = "sample";
        sample.style.fontFamily = fontId;
        sample.textContent = "The quick brown fox jumps over the lazy dog. 0123456789";
        card.appendChild(sample);

        return card;
      }

      async function render() {
        const container = document.getElementById("font-container");
        const manifest = await loadManifest();
        if (!manifest.length) {
          return;
        }

        container.textContent = "";
        manifest.forEach((path, index) => {
          container.appendChild(createCard(path, index));
        });
      }

      render();
    </script>
  </body>
</html>
